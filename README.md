# üìú Netsh Helper DLL Payload Loader

<img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/7921e559-dc7b-4ace-9570-d79241537d75" />


A simple, stealthy DLL that executes arbitrary shellcode when loaded by netsh.exe via the add helper command. 

This project leverages the legitimate "Netsh Helper DLL" functionality in Windows to execute malicious code (shellcode) within the context of the trusted netsh.exe process. Ideal for evasion and lateral movement in Windows environments.

## ‚öôÔ∏è How It Works
Mandatory Entry Point: The Windows netsh.exe utility requires helper DLLs to export a specific function called InitHelperDll (officially documented by Microsoft here ).
Automatic Loading: When you run netsh add helper <path_to_dll>, netsh.exe loads the DLL and immediately calls its InitHelperDll function.
Payload Execution: Inside InitHelperDll, this code:
Allocates executable memory using VirtualAlloc.
Copies an embedded shellcode buffer into this memory.
Executes the shellcode synchronously in the main thread of the netsh.exe process.

<img width="1035" height="992" alt="Captura de pantalla_20250921_232519" src="https://github.com/user-attachments/assets/f52ce1ad-57d6-4c28-adc8-e420fad4fbf8" />

<img width="1721" height="635" alt="image" src="https://github.com/user-attachments/assets/0ac18fb0-153e-417c-8ffc-eef65bc7b9b6" />


## üõ†Ô∏è Compilation
Requires the MinGW-w64 compiler for Windows (x64 target).

```bash
x86_64-w64-mingw32-gcc -shared -o helper.dll main.c -lkernel32 -luser32
Note: You must replace the buf[] array in main.c with your actual shellcode (e.g., generated by msfvenom). 
```
<img width="1705" height="690" alt="image" src="https://github.com/user-attachments/assets/7d66329d-ca8c-4cf8-953e-6ec47207d08a" />

## üöÄ Usage
Upload the compiled DLL (helper.dll) to the target machine.
Execute the following command in a terminal with sufficient privileges (CMD, PowerShell, Evil-WinRM):

```powershell
netsh add helper C:\Full\Path\helper.dll
```
Your shellcode will execute immediately!
If your shellcode is a reverse shell, you should receive a connection on your listener.
The netsh add helper ... command will block/hang if the shellcode does not return (expected behavior for persistent shells).

## üîç Why Use This?
Legitimate Mechanism: Exploits a documented, legitimate Windows feature (netsh helper).
No New Processes: Executes within the trusted netsh.exe process, avoiding suspicious process creation.
Evasion: Can bypass security controls monitoring for new process creation or injection into critical system processes.
Simple & Effective: Straightforward loading and execution mechanism.

## ‚ö†Ô∏è Important Considerations
Architecture: Ensure you compile the DLL for the same architecture (x64) as the target system and its netsh.exe.
Synchronous Execution: The shellcode runs synchronously. This means the netsh add helper command will not return control until the shellcode finishes or the process is killed. This is intentional to ensure the shellcode has time to execute fully.
Shellcode Replacement: The example shellcode ("\d34d\beef") is invalid. You must replace it with your real payload.

## üìÑ License GPLv3
This code is public domain. Use it responsibly and only in authorized environments.

## üìö References
- Official Microsoft Documentation: [InitHelperDll function](https://msdn.microsoft.com/en-us/library/windows/desktop/ms708327)
- Inspiration : [https://github.com/outflanknl/NetshHelperBeacon](https://github.com/outflanknl/NetshHelperBeacon)

## üéì Educational Purpose
This project is intended to:

- Help red teams understand modern C2 evasion techniques.
- Assist blue teams in developing better detection logic.
- Promote research into secure software design and defensive hardening.
- Demonstrate the importance of runtime analysis over static signatures.

## ‚ö†Ô∏è DISCLAIMER - NO WARRANTY OR LIABILITY
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

## üîó Links
- https://deepwiki.com/grisuno/beacon
- https://github.com/grisuno/LazyOwn
- https://grisuno.github.io/LazyOwn/
- https://www.reddit.com/r/LazyOwn/
- https://github.com/grisuno/LazyOwnBT
- https://web.facebook.com/profile.php?id=61560596232150
- https://app.hackthebox.com/teams/overview/6429
- https://app.hackthebox.com/users/1998024
- https://patreon.com/LazyOwn
- https://deepwiki.com/grisuno/ebird3
- https://deepwiki.com/grisuno/hellbird
- https://github.com/grisuno/cgoblin
- https://github.com/grisuno/gomulti_loader
- https://github.com/grisuno/ShadowLink
- https://github.com/grisuno/OverRide
- https://github.com/grisuno/amsi
- https://medium.com/@lazyown.redteam
- https://discord.gg/V3usU8yH
- https://ko-fi.com/Y8Y2Z73AV
- https://medium.com/@lazyown.redteam/black-basalt-beacon-when-your-coff-loader-becomes-a-silent-operator-and-why-thats-by-design-not-4094c92a73a5
- https://github.com/grisuno/LazyOwn/archive/refs/tags/release/0.2.61.tar.gz

![jimeng-2025-06-29-179-Cyberpunk-style logo for 'LazyOwn RedTeam', hacking_pen-testing tool  Colors_ ](https://github.com/user-attachments/assets/83d366ef-f899-4416-8559-20bd9fd34ef4)

![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54) ![Shell Script](https://img.shields.io/badge/shell_script-%23121011.svg?style=for-the-badge&logo=gnu-bash&logoColor=white) ![Flask](https://img.shields.io/badge/flask-%23000.svg?style=for-the-badge&logo=flask&logoColor=white) [![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)

[![ko-fi](https://ko-fi.com/img/githubbutton_sm.svg)](https://ko-fi.com/Y8Y2Z73AV)
